## PowerShell Quick Bites

### Get a list of all Automatic services currently Stopped
```Get-Service | select Name, Status, StartType, DisplayName | where StartType -Match "Automatic" | where Status -Match "Stopped"```

### Get a list of all x64 applications installed
```(Get-ChildItem 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall' |  select $_.PSPath | Get-ItemProperty) | select DisplayName, InstallDate, UninstallString```

### Get information on the latest version of Firefox
```(Invoke-WebRequest -Uri "https://product-details.mozilla.org/1.0/firefox_versions.json" -UseBasicParsing | ConvertFrom-json) | select LAST_RELEASE_DATE, LATEST_FIREFOX_VERSION```

### Download and install the latest version of Firefox
```New-Item -ItemType Directory -Path C:\Temp -Force | Out-Null
$Firefox = (Invoke-WebRequest -Uri "https://product-details.mozilla.org/1.0/firefox_versions.json" -UseBasicParsing | ConvertFrom-json) | select LAST_RELEASE_DATE, LATEST_FIREFOX_VERSION
$FirefoxDownload = "https://download-origin.cdn.mozilla.net/pub/firefox/releases/" + $FIREFOX.LATEST_FIREFOX_VERSION + "/win64/en-US/Firefox%20Setup%20" + $FIREFOX.LATEST_FIREFOX_VERSION + ".exe"
Invoke-WebRequest -Uri $FirefoxDownload -UseBasicParsing -OutFile "C:\Temp\Firefox_$($FIREFOX.LATEST_FIREFOX_VERSION).exe"
Start-Process -NoNewWindow -FilePath "C:\Temp\Firefox_$FirefoxVersion.exe" -ArgumentList /S
```

### Reset Outlook default font to Arial (run as user)
```if((Test-Path -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\MailSettings") -ne $true) {  New-Item "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\MailSettings" -force -ErrorAction SilentlyContinue | Out-Null }
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'Template' -Value '' -PropertyType ExpandString -Force -ErrorAction SilentlyContinue | Out-Null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'NewTheme' -Value '' -PropertyType String -Force -ErrorAction SilentlyContinue | Out-Null;
Remove-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'MarkCommentsWith' -Force -ErrorAction SilentlyContinue | Out-Null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'ComposeFontComplex' -Value ([byte[]](0x3c,0x68,0x74,0x6d,0x6c,0x3e,0x0d,0x0a,0x0d,0x0a,0x3c,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x3c,0x73,0x74,0x79,0x6c,0x65,0x3e,0x0d,0x0a,0x0d,0x0a,0x20,0x2f,0x2a,0x20,0x53,0x74,0x79,0x6c,0x65,0x20,0x44,0x65,0x66,0x69,0x6e,0x69,0x74,0x69,0x6f,0x6e,0x73,0x20,0x2a,0x2f,0x0d,0x0a,0x20,0x73,0x70,0x61,0x6e,0x2e,0x50,0x65,0x72,0x73,0x6f,0x6e,0x61,0x6c,0x43,0x6f,0x6d,0x70,0x6f,0x73,0x65,0x53,0x74,0x79,0x6c,0x65,0x0d,0x0a,0x09,0x7b,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x6e,0x61,0x6d,0x65,0x3a,0x22,0x50,0x65,0x72,0x73,0x6f,0x6e,0x61,0x6c,0x20,0x43,0x6f,0x6d,0x70,0x6f,0x73,0x65,0x20,0x53,0x74,0x79,0x6c,0x65,0x22,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x74,0x79,0x70,0x65,0x3a,0x70,0x65,0x72,0x73,0x6f,0x6e,0x61,0x6c,0x2d,0x63,0x6f,0x6d,0x70,0x6f,0x73,0x65,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x6e,0x6f,0x73,0x68,0x6f,0x77,0x3a,0x79,0x65,0x73,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x75,0x6e,0x68,0x69,0x64,0x65,0x3a,0x6e,0x6f,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x61,0x6e,0x73,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x31,0x31,0x2e,0x30,0x70,0x74,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x31,0x31,0x2e,0x30,0x70,0x74,0x3b,0x0d,0x0a,0x09,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x22,0x41,0x72,0x69,0x61,0x6c,0x22,0x2c,0x73,0x61,0x6e,0x73,0x2d,0x73,0x65,0x72,0x69,0x66,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x61,0x73,0x63,0x69,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x41,0x72,0x69,0x61,0x6c,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x68,0x61,0x6e,0x73,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x41,0x72,0x69,0x61,0x6c,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x22,0x54,0x69,0x6d,0x65,0x73,0x20,0x4e,0x65,0x77,0x20,0x52,0x6f,0x6d,0x61,0x6e,0x22,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x74,0x68,0x65,0x6d,0x65,0x2d,0x66,0x6f,0x6e,0x74,0x3a,0x6d,0x69,0x6e,0x6f,0x72,0x2d,0x62,0x69,0x64,0x69,0x3b,0x0d,0x0a,0x09,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x77,0x69,0x6e,0x64,0x6f,0x77,0x74,0x65,0x78,0x74,0x3b,0x7d,0x0d,0x0a,0x2d,0x2d,0x3e,0x0d,0x0a,0x3c,0x2f,0x73,0x74,0x79,0x6c,0x65,0x3e,0x0d,0x0a,0x3c,0x2f,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x0d,0x0a,0x3c,0x2f,0x68,0x74,0x6d,0x6c,0x3e,0x0d,0x0a)) -PropertyType Binary -Force -ErrorAction SilentlyContinue | out-null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'ComposeFontSimple' -Value ([byte[]](0x3c,0x00,0x00,0x00,0x1f,0x00,0x00,0xf8,0x00,0x00,0x00,0x40,0xdc,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x22,0x41,0x72,0x69,0x61,0x6c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00)) -PropertyType Binary -Force -ErrorAction SilentlyContinue | Out-Null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'ReplyFontComplex' -Value ([byte[]](0x3c,0x68,0x74,0x6d,0x6c,0x3e,0x0d,0x0a,0x0d,0x0a,0x3c,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x3c,0x73,0x74,0x79,0x6c,0x65,0x3e,0x0d,0x0a,0x0d,0x0a,0x20,0x2f,0x2a,0x20,0x53,0x74,0x79,0x6c,0x65,0x20,0x44,0x65,0x66,0x69,0x6e,0x69,0x74,0x69,0x6f,0x6e,0x73,0x20,0x2a,0x2f,0x0d,0x0a,0x20,0x73,0x70,0x61,0x6e,0x2e,0x50,0x65,0x72,0x73,0x6f,0x6e,0x61,0x6c,0x52,0x65,0x70,0x6c,0x79,0x53,0x74,0x79,0x6c,0x65,0x0d,0x0a,0x09,0x7b,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x6e,0x61,0x6d,0x65,0x3a,0x22,0x50,0x65,0x72,0x73,0x6f,0x6e,0x61,0x6c,0x20,0x52,0x65,0x70,0x6c,0x79,0x20,0x53,0x74,0x79,0x6c,0x65,0x22,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x74,0x79,0x70,0x65,0x3a,0x70,0x65,0x72,0x73,0x6f,0x6e,0x61,0x6c,0x2d,0x72,0x65,0x70,0x6c,0x79,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x6e,0x6f,0x73,0x68,0x6f,0x77,0x3a,0x79,0x65,0x73,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x75,0x6e,0x68,0x69,0x64,0x65,0x3a,0x6e,0x6f,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x61,0x6e,0x73,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x31,0x31,0x2e,0x30,0x70,0x74,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x31,0x31,0x2e,0x30,0x70,0x74,0x3b,0x0d,0x0a,0x09,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x22,0x41,0x72,0x69,0x61,0x6c,0x22,0x2c,0x73,0x61,0x6e,0x73,0x2d,0x73,0x65,0x72,0x69,0x66,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x61,0x73,0x63,0x69,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x41,0x72,0x69,0x61,0x6c,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x68,0x61,0x6e,0x73,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x41,0x72,0x69,0x61,0x6c,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x22,0x54,0x69,0x6d,0x65,0x73,0x20,0x4e,0x65,0x77,0x20,0x52,0x6f,0x6d,0x61,0x6e,0x22,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x74,0x68,0x65,0x6d,0x65,0x2d,0x66,0x6f,0x6e,0x74,0x3a,0x6d,0x69,0x6e,0x6f,0x72,0x2d,0x62,0x69,0x64,0x69,0x3b,0x0d,0x0a,0x09,0x63,0x6f,0x6c,0x6f,0x72,0x3a,0x77,0x69,0x6e,0x64,0x6f,0x77,0x74,0x65,0x78,0x74,0x3b,0x7d,0x0d,0x0a,0x2d,0x2d,0x3e,0x0d,0x0a,0x3c,0x2f,0x73,0x74,0x79,0x6c,0x65,0x3e,0x0d,0x0a,0x3c,0x2f,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x0d,0x0a,0x3c,0x2f,0x68,0x74,0x6d,0x6c,0x3e,0x0d,0x0a)) -PropertyType Binary -Force -ErrorAction SilentlyContinue | Out-Null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'ReplyFontSimple' -Value ([byte[]](0x3c,0x00,0x00,0x00,0x1f,0x00,0x00,0xf8,0x00,0x00,0x00,0x40,0xdc,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x22,0x41,0x72,0x69,0x61,0x6c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00)) -PropertyType Binary -Force -ErrorAction SilentlyContinue | Out-Null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'TextFontComplex' -Value ([byte[]](0x3c,0x68,0x74,0x6d,0x6c,0x3e,0x0d,0x0a,0x0d,0x0a,0x3c,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x3c,0x73,0x74,0x79,0x6c,0x65,0x3e,0x0d,0x0a,0x0d,0x0a,0x20,0x2f,0x2a,0x20,0x53,0x74,0x79,0x6c,0x65,0x20,0x44,0x65,0x66,0x69,0x6e,0x69,0x74,0x69,0x6f,0x6e,0x73,0x20,0x2a,0x2f,0x0d,0x0a,0x20,0x70,0x2e,0x4d,0x73,0x6f,0x50,0x6c,0x61,0x69,0x6e,0x54,0x65,0x78,0x74,0x2c,0x20,0x6c,0x69,0x2e,0x4d,0x73,0x6f,0x50,0x6c,0x61,0x69,0x6e,0x54,0x65,0x78,0x74,0x2c,0x20,0x64,0x69,0x76,0x2e,0x4d,0x73,0x6f,0x50,0x6c,0x61,0x69,0x6e,0x54,0x65,0x78,0x74,0x0d,0x0a,0x09,0x7b,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x6e,0x6f,0x73,0x68,0x6f,0x77,0x3a,0x79,0x65,0x73,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x70,0x72,0x69,0x6f,0x72,0x69,0x74,0x79,0x3a,0x39,0x39,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x73,0x74,0x79,0x6c,0x65,0x2d,0x6c,0x69,0x6e,0x6b,0x3a,0x22,0x50,0x6c,0x61,0x69,0x6e,0x20,0x54,0x65,0x78,0x74,0x20,0x43,0x68,0x61,0x72,0x22,0x3b,0x0d,0x0a,0x09,0x6d,0x61,0x72,0x67,0x69,0x6e,0x3a,0x30,0x69,0x6e,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x70,0x61,0x67,0x69,0x6e,0x61,0x74,0x69,0x6f,0x6e,0x3a,0x77,0x69,0x64,0x6f,0x77,0x2d,0x6f,0x72,0x70,0x68,0x61,0x6e,0x3b,0x0d,0x0a,0x09,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x31,0x31,0x2e,0x30,0x70,0x74,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x73,0x69,0x7a,0x65,0x3a,0x31,0x30,0x2e,0x35,0x70,0x74,0x3b,0x0d,0x0a,0x09,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x22,0x41,0x72,0x69,0x61,0x6c,0x22,0x2c,0x73,0x61,0x6e,0x73,0x2d,0x73,0x65,0x72,0x69,0x66,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x66,0x61,0x72,0x65,0x61,0x73,0x74,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x43,0x61,0x6c,0x69,0x62,0x72,0x69,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x66,0x61,0x72,0x65,0x61,0x73,0x74,0x2d,0x74,0x68,0x65,0x6d,0x65,0x2d,0x66,0x6f,0x6e,0x74,0x3a,0x6d,0x69,0x6e,0x6f,0x72,0x2d,0x6c,0x61,0x74,0x69,0x6e,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x66,0x6f,0x6e,0x74,0x2d,0x66,0x61,0x6d,0x69,0x6c,0x79,0x3a,0x22,0x54,0x69,0x6d,0x65,0x73,0x20,0x4e,0x65,0x77,0x20,0x52,0x6f,0x6d,0x61,0x6e,0x22,0x3b,0x0d,0x0a,0x09,0x6d,0x73,0x6f,0x2d,0x62,0x69,0x64,0x69,0x2d,0x74,0x68,0x65,0x6d,0x65,0x2d,0x66,0x6f,0x6e,0x74,0x3a,0x6d,0x69,0x6e,0x6f,0x72,0x2d,0x62,0x69,0x64,0x69,0x3b,0x7d,0x0d,0x0a,0x2d,0x2d,0x3e,0x0d,0x0a,0x3c,0x2f,0x73,0x74,0x79,0x6c,0x65,0x3e,0x0d,0x0a,0x3c,0x2f,0x68,0x65,0x61,0x64,0x3e,0x0d,0x0a,0x0d,0x0a,0x3c,0x2f,0x68,0x74,0x6d,0x6c,0x3e,0x0d,0x0a)) -PropertyType Binary -Force -ErrorAction SilentlyContinue | Out-Null;
New-ItemProperty -LiteralPath "HKCU:\SOFTWARE\Microsoft\Office\16.0\Common\Mailsettings" -Name 'TextFontSimple' -Value ([byte[]](0x3c,0x00,0x00,0x00,0x1f,0x00,0x00,0xf8,0x00,0x00,0x00,0x40,0xdc,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x22,0x41,0x72,0x69,0x61,0x6c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00)) -PropertyType Binary -Force -ErrorAction SilentlyContinue | Out-Null;
```

### List all main Windows Updates (KBs) installed on a computer, and put them into Grid View (Note: Remove the query on Title for all updates - drivers, etc.)
``` (new-object -com "Microsoft.Update.Searcher").QueryHistory(0,((new-object -com "Microsoft.Update.Searcher").gettotalhistorycount()-1)) | where Title -Match "KB" | select Title, Description, Date | Out-GridView```
